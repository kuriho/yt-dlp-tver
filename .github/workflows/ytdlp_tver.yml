name: TVer

on:
  schedule:
    - cron: '0 20 * * *'  # Customize the cron schedule as desired
  workflow_dispatch:

jobs:
  sparse-checkout:
    runs-on: ubuntu-latest

    steps:
      - name: Clone Monorepo
        uses: dfdez/checkout@feat/sparse-checkout
        with:
          repository: yt-dlp/yt-dlp
          ref: master
          path: lib
          fetch-depth: 1
          sparse-checkout: |
            --no-cone
            yt_dlp/* 
            !yt_dlp/extractor/*

      - name: List Cloned Files
        run: |
          git init
          ls -R

      - name: Sparse Checkout
        run: |
          git sparse-checkout init --cone
          git sparse-checkout set yt_dlp/* !yt_dlp/extractor/* --no-cone
          git sparse-checkout add yt_dlp/extractor/brightcove.py yt_dlp/extractor/tver.py --no-cone
        working-directory: lib
          
      - name: Commit changes
        uses: EndBug/add-and-commit@v9
        with:
          author_name: Your Name
          author_email: mail@example.com
          message: 'Your commit message'
          add: 'lib'
          push: --set-upstream origin master
          repository: "kuriho/actions"
